ユースケース名:
  アプリケーション運用者が仮想サーバの状態を確認する

背景:
  分散バッチ環境を正しく設定し、分散バッチの実行状況を確認する上で、その実行環境の
  状態を随時取得できる必要がある。
  実行環境で状態を監視すべき対象として、
        ・物理サーバ
        ・仮想サーバ
        が挙げられる。このユースケースでは、
        ・仮想サーバ
        を扱う。

  仮想サーバについて確認すべき状態として、以下が考えられる。
  ・稼働している仮想サーバと対応する物理サーバの一覧
  ・稼働している仮想サーバ毎の設定と状態
  ・分散バッチの実行中に問題が発生した場合の、仮想サーバの稼働状況

  これらの状態を随時確認するために、仮想サーバの状態をリアルタイムで取得し、閲覧で
  きる機能が必要である。


概要:
  アプリケーション運用者は、[仮想サーバ一覧]で物理サーバ上で起動している仮想
  サーバの状態を確認する。
  仮想サーバ、物理サーバの状態はTengineリソースウォッチャのデーモンプロセスが、プロバイダに問い合わせを行い、リソースストアに書き込む。
  仮想サーバ、物理サーバの状態を取得して表示する部分はサーバ仮想基盤に対して行うのではなく、リソースストアに対して行う。

事前条件:
  Tengineがセットアップされている。
  Tengineと連携するサーバ仮想基盤がセットアップされている。
  Tengineリソースウォッチャプロセスが起動している
  制御対象の物理サーバが起動している。

成功時保証:
  アプリケーション運用者が指定した条件に対応するすべての仮想サーバの状態を確認できる。

最低保証:
  なし

登場する画面:
  仮想サーバ一覧

登場するコンポーネント:
  なし

登場するパッケージ:

登場するドキュメント:

関連するユースケース：
  アプリケーション運用者が仮想サーバを起動する
  アプリケーション運用者が仮想サーバを停止する

基本コース:
 1. アプリケーション運用者は「仮想サーバ一覧」を開く。<戻り点:仮想サーバ一覧の表示>
 2. 「仮想サーバ一覧」はTengineに物理サーバ、仮想サーバの情報を問い合わせる。
 3. Tengineはリソースストアから管理下の物理サーバと関連する仮想サーバの情報を取得する。
 4. Tengineは「仮想サーバ一覧」に物理サーバと仮想サーバの情報を報告する。
 5. 「仮想サーバ一覧」は物理サーバ上でどの仮想サーバが動いているかを出力する。
 6. アプリケーション運用者は「仮想サーバ一覧」から、現在どの物理サーバでどのイメージの仮想サーバが起動しているかを確認する。[代替コースA][代替コースB][代替コースC][代替コースD][代替コースE]

代替コースA: 仮想サーバ一覧表をソートして表示する。
 1. アプリケーション運用者は、「仮想サーバ一覧」の一覧表にある「IPアドレス」をクリックする。
 2. 「仮想サーバ一覧」はTengineに仮想サーバの情報をIPアドレスの昇順にソートして報告するよう問い合わせる。
 3. Tengineはリソースストアから仮想サーバの情報をIPアドレスの昇順で取得する。
 4. Tengineは「仮想サーバ一覧」に管理下の仮想サーバの情報をIPアドレスの昇順で返却する。
 5. 「仮想サーバ一覧」は仮想サーバの情報をIPアドレスの昇順に出力する。
 6. アプリケーション運用者は「仮想サーバ一覧」で仮想サーバの一覧がIPアドレスの昇順で表示されていることを確認する。[代替コースF]

###### 秋間コメント: ソートする場合、物理サーバ毎に表示するのをやめるのでしょうか？


代替コースB: 仮想サーバ一覧表を絞り込み検索して表示する。
 1. アプリケーション運用者は、「仮想サーバ一覧」の検索条件で「」を入力する。
 2. 「仮想サーバ一覧」はTengineに（検索条件を記入）管理下の仮想サーバの情報を問い合わせる。
 3. Tengineはリソースストアから仮想サーバの情報を「」で絞り込んだ結果を取得する。
 4. Tengineは「仮想サーバ一覧」に管理下の物理サーバの情報を絞り込んで返却する。
 5. 「仮想サーバ一覧」は（検索条件を記入）絞りこまれた仮想サーバの情報を出力する。
 6. アプリケーション運用者は「仮想サーバ一覧」で仮想サーバの一覧が検索条件で絞りこまれて表示されていることを確認する。[代替コースG]

代替コースC：管理下の仮想サーバが存在しない
 ## 物理サーバが存在しており、仮想サーバが存在しない時に、画面表示に問題がないことを確認する
 1. アプリケーション運用者は「仮想サーバ一覧」から、利用可能な物理サーバが存在することを確認する。
 2. アプリケーション運用者が「仮想サーバ一覧」から、仮想サーバが存在しないことを確認する。

代替コースD: 管理下の物理サーバが存在しない
 ## 管理下の物理サーバが0台のときに画面表示に問題がないことを確認する
 1. アプリケーション運用者は「仮想サーバ一覧」から、利用可能な物理サーバが存在しないことを確認する。
 2. アプリケーション運用者は「仮想サーバ一覧」から、「物理サーバ管理」リンクを押下する。
 3. アプリケーション運用者は「物理サーバ一覧」から、利用可能な物理サーバが存在しないことを確認する。
 4. アプリケーション運用者はサーバ仮想基盤に物理サーバの登録を行う
 5. Tengineリソースウォッチャプロセスが、サーバ仮想基盤に追加した物理サーバの状態をリソースストアに登録する。
 6. <戻り点:仮想サーバ一覧の表示>に遷移する

代替コースE：検索条件にマッチする項目が0件である
 ## 検索結果が0台のときに画面表示に問題がないことを確認する
 1. アプリケーション運用者は、「仮想サーバ一覧」の検索条件で「」(結果が0台になる条件)を入力する。
 2. 「仮想サーバ一覧」はTengineに（検索条件を記入）仮想サーバの情報を問い合わせる。
 3. Tengineはリソースストアから仮想サーバの情報を0台で取得する。
 4. Tengineは「仮想サーバ一覧」に管理下の仮想サーバの情報を0台で返却する。
 5. 「仮想サーバ一覧」は（検索条件を記入）絞りこまれた仮想サーバの情報を出力する。
 6. アプリケーション運用者は「仮想サーバ一覧」で仮想サーバの一覧が0件であることを確認する。

代替コースF: ソートしている状態でページ切り替えを行う
 ## ソート後にページ切り替えを行なってもソート順が適用されていることを確認する
 1. アプリケーション運用者は、「仮想サーバ一覧」の「次へリンクを押下する
 2. 「仮想サーバ一覧」はTengineにIPアドレスの昇順のソートとページ番号を指定して物理サーバの情報を問い合わせる。
 3. Tengineはリソースストアから仮想サーバの情報をIPアドレスの昇順とページ数で件数を制御して取得する。
 4. Tengineは「仮想サーバ一覧」にリソースストアから取得した管理下の仮想サーバの情報とページ数を返却する。
 5. 「仮想サーバ一覧」は仮想サーバの情報をIPアドレスの昇順に出力し、ページ数を表示する。
 6. アプリケーション運用者は「仮想サーバ一覧」でソートを維持したままページが変わっていることを確認する

代替コースG: 絞り込み検索をしている状態でページ切り替えを行う
 ## 検索後にページ切り替えを行なっても検索条件が適用されていることを確認する
 1. アプリケーション運用者は、「仮想サーバ一覧」の「次へ」リンクを押下する
 2. 「仮想サーバ一覧」はTengineに検索条件に合致する仮想サーバの情報をページ番号を指定して問い合わせる。
 3. Tengineはリソースストアから仮想サーバの情報を検索条件とページ数で件数を制御して取得する。
 4. Tengineは「仮想サーバ一覧」にリソースストアから取得した管理下の仮想サーバの情報とページ数を返却する。
 5. 「仮想サーバ一覧」は仮想サーバの情報をIPアドレスの昇順に出力し、ページ数を表示する。
 6. アプリケーション運用者は「仮想サーバ一覧」で検索条件を維持したままページが変わっていることを確認する
