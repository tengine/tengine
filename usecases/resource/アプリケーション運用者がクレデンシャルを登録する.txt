ユースケース名:
  アプリケーション運用者がクレデンシャルを登録する

背景:
  ジョブを実行するにはその実行対象のサーバのクレデンシャル(認証情報)が必要である。
  アプリケーション運用者は認証情報設定画面から認証情報に名前をつけて登録を行い、
  ジョブ実行時に登録された名前を指定して実行する。
  そのため、通常はジョブDSLを作成前に必要なクレデンシャルの登録は完了している。

概要:
  クレデンシャルは以下の3種類が存在する
   * SSH公開鍵認証
   * SSHパスワード認証
   * EC2アクセスキー認証
  
  登録・更新時のバリデーションは以下のとおり
   * 名称: 必須、一意
   * 記述: なし
   * 認証種別: 必須
     * SSH公開鍵認証
       * ユーザー名: 必須
       * 秘密鍵: 必須
       * パスフレーズ: 必須
     * SSHパスワード認証
       * ユーザー名: 必須
       * パスワード: 必須
     * EC2アクセスキー認証
       * アクセスキー: 必須
       * シークレットアクセスキー: 必須
       * 初期リージョン: なし(デフォルトUS East)

事前条件:
  Tengineコンソール画面が使用できる。
  ジョブを実行する対象のサーバのクレデンシャルを知っている。

成功時保証:
  アプリケーション運用者がクレデンシャルの登録が完了したことを確認できる。

最低保証:
  なし

登場する画面:
  認証情報画面

登場するコンポーネント:

登場するパッケージ:

登場するドキュメント:

基本コース:
## 基本コースではSSH公開鍵認証を使用している
 1. アプリケーション運用者は「認証情報一覧画面」を開く。
 2. 「認証情報一覧画面」はTengineに認証情報を問い合わせる。
 3. Tengineは認証情報を「認証情報一覧画面」に返却する。[代替コースC]
 4. 「認証情報一覧画面」は登録済みの認証情報を表示する。
 5. アプリケーション運用者は「認証情報一覧画面」で登録済みの認証情報を確認する。
 6. アプリケーション運用者は「認証情報一覧画面」で「新規登録リンク」を押下して「認証情報登録画面」に遷移する。<戻り点:認証情報の登録>
 7. アプリケーション運用者は「認証情報登録画面」で認証種別に「SSH公開鍵認証」を選択する[代替コースA][代替コースB]
 8. 「認証情報登録画面」は入力欄にユーザー名、秘密鍵、パスフレーズを表示する。
 9. アプリケーション運用者は「認証情報登録画面」でユーザー名、秘密鍵、パスフレーズを入力し、「登録ボタン」を押下する。[代替コースJ]
10. Tengineはアプリケーション運用者が入力した内容をデータストアに追加する。<戻り点:認証情報の追加>
11. Tengineは登録した結果を「認証情報閲覧画面」に返却する。
12. アプリケーション運用者は「認証情報閲覧画面」で認証情報が登録されたことを確認する。
13. アプリケーション運用者は「認証情報閲覧画面」の「一覧に戻るリンク」を押下して「認証情報一覧画面」に遷移する。
14. アプリケーション運用者は「認証情報一覧画面」で認証情報が追加されたことを確認する。[代替コースD][代替コースE][代替コースF][代替コースG]

代替コースA: SSHパスワード認証を使用する
 1. アプリケーション運用者は「認証情報登録画面」で認証種別に「SSHパスワード認証」を選択する
 2. 「認証情報登録画面」は入力欄にユーザー名、パスワードを表示する。
 3. アプリケーション運用者は「認証情報登録画面」でユーザー名、パスワードを入力し、「登録ボタン」を押下する
 4. <戻り点:認証情報の追加>に遷移する。

代替コースB: EC2アクセスキー認証を使用する
 1. アプリケーション運用者は「認証情報登録画面」で認証種別に「EC2アクセスキー認証」を選択する
 2. 「認証情報登録画面」は入力欄にアクセスキー、シークレットアクセスキー、初期リージョンを表示する。
 3. アプリケーション運用者は「認証情報登録画面」でアクセスキー、シークレットアクセスキー、初期リージョンを入力し、「登録ボタン」を押下する
 4. <戻り点:認証情報の追加>に遷移する。

代替コースC: 登録している認証情報が0件の場合
## 認証情報が0件でもエラーにならないことを確認
 1. Tengineは0件の認証情報を「認証情報一覧画面」に返却する。
 2. アプリケーション運用者は「認証情報一覧画面」で登録済みの認証情報が存在しないことを確認する。
 3. <戻り点:認証情報の追加>に遷移する。
 
代替コースD: 絞り込み検索を利用して表示対象の絞込み検索を行う
 1. アプリケーション運用者は「認証情報一覧画面」で名称に検索条件を入力して「検索ボタン」を押下する。
 2. Tengineは名称で絞り込んだ認証情報を「認証情報一覧画面」に返却する。
 3. 「認証情報一覧画面」は条件を絞り込んた認証情報を表示する。
 4. アプリケーション運用者は「認証情報一覧画面」で認証情報が名称で絞りこまれていることを確認する。[代替コースH]

代替コースE: ソート機能を利用して表示対象のソートを行う
 1. アプリケーション運用者は「認証情報一覧画面」で名称のヘッダを押下する。
 2. Tengineは名称の降順にソートした認証情報を「認証情報一覧画面」に返却する。
 3. 「認証情報一覧画面」は名称の降順でソートした認証情報を表示する。
 4. アプリケーション運用者は「認証情報一覧画面」で認証情報が名称の降順でソートされていることを確認する。[代替コースI]

代替コースF: 登録した認証情報を変更する
 1. アプリケーション運用者は「認証情報一覧画面」で間違えて登録した認証情報の「変更リンク」を押下する。
 2. Tengineは対象の認証情報を「認証情報編集画面」に返却する。
 3. 「認証情報編集画面」は対象の認証情報を表示する。
 4. アプリケーション運用者は「認証情報編集画面」にて、内容の変更を行い「更新ボタン」を押下する。
 3. Tengineは対象の認証情報を更新する。
 4. Tengineは認証情報群を「認証情報閲覧画面」に返却する。
 5. 「認証閲覧画面」は認証情報を表示する。
 6. アプリケーション運用者は「認証閲覧画面」で認証情報が変更されていることを確認する。

代替コースG: 登録した認証情報を削除する
 1. アプリケーション運用者は「認証情報一覧画面」で間違えて登録した認証情報の「削除リンク」を押下する。
 2. アプリケーション運用者は確認ダイアログのOKボタンを押下する。
 3. Tengineは対象の認証情報を削除する。
 4. Tengineは認証情報群を「認証情報一覧画面」に返却する。
 5. 「認証情報一覧画面」は認証情報を表示する。
 6. アプリケーション運用者は「認証情報一覧画面」で削除した認証情報が存在しないことを確認する。

代替コースH: 絞り込み検索をしている状態でページ切り替えを行う
 ## 検索後にページ切り替えを行なっても検索条件が適用されていることを確認する
 1. アプリケーション運用者は、「認証情報一覧画面」の「次へ」リンクを押下する
 2. 「認証情報一覧画面」はTengineに検索条件に合致する認証情報をページ番号を指定して問い合わせる。
 3. Tengineはデータストアから認証情報を検索条件とページ数で件数を制御して取得する。
 4. Tengineは「認証情報一覧画面」にデータストアから取得した管理下の認証情報とページ数を返却する。
 5. 「認証情報一覧画面」は絞り込んだ認証情報を出力し、ページ数を表示する。
 6. アプリケーション運用者は「認証情報一覧画面」で検索条件を維持したままページが変わっていることを確認する

代替コースI: ソートしている状態でページ切り替えを行う
 ## ソート後にページ切り替えを行なってもソート順が適用されていることを確認する
 1. アプリケーション運用者は、「認証情報一覧画面」の「次へリンクを押下する
 2. 「認証情報一覧画面」はTengineに名称の降順のソートとページ番号を指定して認証情報を問い合わせる。
 3. Tengineはデータストアから認証情報を名称の降順とページ数で件数を制御して取得する。
 4. Tengineは「認証情報一覧画面」にデータストアから取得した認証情報とページ数を返却する。
 5. 「認証情報画面」は認証情報を名称の降順に出力し、ページ数を表示する。
 6. アプリケーション運用者は「認証情報一覧画面」でソートを維持したままページが変わっていることを確認する

代替コースJ: 登録時にバリデーションチェックに引っかかった場合
 ## バリデーションに関してはユースケースでは網羅はしない
 1. アプリケーション運用者は「認証情報登録画面」でユーザー名、秘密鍵、パスフレーズ全て未入力で入力し、「登録ボタン」を押下する。
 2. Tengineはバリデーションチェックに引っかかったため、「認証情報登録画面」に遷移する。
 3. アプリケーション運用者は「認証情報登録画面」に「ユーザー名が入力されていません」「秘密鍵が入力されていません」「パスフレーズが入力されていません」と表示されていることを確認する
 4. <戻り点:認証情報の登録>に遷移する。
